@model IEnumerable<Template.Mvc4.Models.Contact>
@{
  ViewBag.Title = "Knockout Contacts";
}
@{if (false)
  {
  <script src="Social.js" type="text/javascript"></script>
  <script src="/Content/lib/jquery/jquery-1.7.1.min.js" type="text/javascript"></script> 
  }
}
<ul class="triggers" data-bind="foreach: triggers">
  <li class="trigger">
    <span data-bind="click: $parent.selectTrigger">
      <span data-bind="text: title"></span>
    </span>
    <span>
      <button class="trigger-details">Details</button>
      <a href="#" class="trigger-edit">Edit</a>
      <a href="#" class="trigger-delete">Delete</a>
    </span>
    <ul class="activities" data-bind="foreach: activities">
      <li class="activity" data-bind="click: $parent.selectActivity">
        <span data-bind="text: niceDate"></span>
        <ul class="channels" data-bind="foreach: channels">
          <li class="channel">
            <span data-bind="text: channel"></span>
            <button class="channel-delete">Delete</button>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
@section pageScripts
{
  <script src="/Views/_Scripts/ko-protected-observable.js" type="text/javascript"></script>
  <script src="/Views/_Scripts/CrudHelpers.js" type="text/javascript"></script>
  <script src="/Content/lib/knockout/knockout-1.3.0beta.js" type="text/javascript"></script>
  <script src="@Url.Content("~/Views/_Scripts/CrudHelpers.js")" type="text/javascript"></script>
  <script src="@Url.Content("~/Views/Social/Social.js")" type="text/javascript"></script>
  <script type="text/javascript">
    $(function () {
      $('.trigger-details').click(function () {
        $(this.parentNode.parentNode).children('.activities').show()
      });
    });
  </script>
}
<style type="text/css">
  ul span
  {
    margin: 5px;
  }
  .activities
  {
    display: none;
  }
  .activity
  {
    display: block;
  }
  .channels, .channel
  {
    display: inline;
  }
  ul ul { background: red; }
  ul ul ul li{ background: blue !important; }
</style>
